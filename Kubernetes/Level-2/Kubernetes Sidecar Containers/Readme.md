#### Question
We have a web server container running the nginx image. The access and error logs generated by the web server are not critical enough to be placed on a persistent volume. However, Nautilus developers need access to the last 24 hours of logs so that they can trace issues and bugs. Therefore, we need to ship the access and error logs for the web server to a log-aggregation service. Following the separation of concerns principle, we implement the Sidecar pattern by deploying a second container that ships the error and access logs from nginx. Nginx does one thing, and it does it well—serving web pages. The second container also specializes in its task—shipping logs. Since containers are running on the same Pod, we can use a shared emptyDir volume to read and write logs.

Create a pod named webserver.

Create an emptyDir volume shared-logs.

Create two containers from nginx and ubuntu images with latest tag only and remember to mention tag i.e nginx:latest, nginx container name should be nginx-container and ubuntu container name should be sidecar-container on webserver pod.

Add command on sidecar-container "sh","-c","while true; do cat /var/log/nginx/access.log /var/log/nginx/error.log; sleep 30; done"

Mount the volume shared-logs on both containers at location /var/log/nginx, all containers should be up and running.

#### Solution
1.Create a Pod with Nginx and Sidecar Containers

Create a YAML file named webserver-pod.yaml with the following content:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: webserver
spec:
  containers:
  - name: nginx-container
    image: nginx:latest
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/nginx
  
  - name: sidecar-container
    image: ubuntu:latest
    command: ["sh", "-c", "while true; do cat /var/log/nginx/access.log /var/log/nginx/error.log; sleep 30; done"]
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/nginx

  volumes:
  - name: shared-logs
    emptyDir: {}
```

Apply the configuration to your Kubernetes cluster:

```bash
kubectl apply -f webserver-pod.yaml
```

2.Verify Container Logs

Check Logs from the Sidecar Container

The sidecar container should display the concatenated contents of access.log and error.log. To view the logs:

```bash
kubectl logs webserver -c sidecar-container
```

3.Check Logs from the Nginx Container

If you need to check the startup logs of the nginx container:

```bash
kubectl logs webserver -c nginx-container
```

4.Verify the Logs Handling

Access Logs:

Ensure that the logs are being generated and correctly written to the /var/log/nginx directory in the nginx container.

File Visibility:

The sidecar-container should show the logs of the nginx server as it reads from the shared volume. If logs are missing, check the volume mount paths and container configurations.